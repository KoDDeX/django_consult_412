# Lesson 48

## Знакомство с ORM
Django ORM - это инструмент, который позволяет работать с базой данных, используя Python-код вместо SQL-запросов. Он позволяет создавать, читать, обновлять и удалять записи в базе данных с помощью объектов Python.

ORM (Object-Relational Mapping) - это метод, который позволяет работать с реляционными базами данных, используя объектно-ориентированный подход. Он позволяет разработчикам работать с базой данных, используя объекты и классы, а не SQL-запросы.

## Создание таблицы

```python
class Order(models.Model):
    # id - генерируется автоматически
    client_name = models.CharField(max_length=100)
    services = models.CharField(max_length=200)
    master_id = models.IntegerField()
    date = models.DateField()
    status = models.CharField(max_length=50)
```

`models.Model` - это базовый класс, от которого наследуются все модели Django. Он предоставляет методы и атрибуты для работы с базой данных.

`models.CharField` - это поле, которое хранит строку фиксированной длины. `max_length` - это максимальная длина строки.

## Другие типы полей
- `TextField` - для хранения длинных текстов
- `SlugField` - для хранения коротких строк, обычно используемых в URL
- `CharField` - для хранения коротких строк
- `IntegerField` - для хранения целых чисел
- `FloatField` - для хранения чисел с плавающей точкой
- `BooleanField` - для хранения логических значений (True/False)
- `DateField` - для хранения дат
- `DateTimeField` - для хранения даты и времени
- `EmailField` - для хранения адресов электронной почты
- `URLField` - для хранения URL-адресов

## Типы валидаторов и свойств

- `max_length` - максимальная длина строки
- `min_length` - минимальная длина строки
- `blank` - позволяет ли поле быть пустым
- `null` - позволяет ли поле быть NULL в базе данных
- `choices` - позволяет задать список допустимых значений для поля
- `default` - значение по умолчанию для поля
- `unique` - уникальность значения в базе данных
- `db_index` - создание индекса для поля в базе данных
- `validators` - список валидаторов для поля

## Создание и применение миграций

После создания модели необходимо создать миграцию, которая создаст таблицу в базе данных. Для этого нужно выполнить команду:

```bash
python manage.py makemigrations
```

Эта команда создаст файл миграции в папке `migrations` вашего приложения. Файл миграции содержит информацию о том, какие изменения были внесены в модели.

После создания миграции необходимо применить ее к базе данных. Для этого нужно выполнить команду:

```bash
python manage.py migrate
```

Миграции **обязательно пушим на GitHub**. Это позволяет другим разработчикам видеть изменения в базе данных и применять их к своей локальной базе данных. Также это позволяет избежать конфликтов при работе с базой данных в команде.

## Django Shell Plus

Django Shell Plus - это расширенная версия Django Shell, которая автоматически импортирует все модели вашего проекта. Это позволяет вам работать с моделями и выполнять запросы к базе данных без необходимости вручную импортировать каждую модель.

Для установки Django Shell Plus необходимо установить пакет `django-extensions`. Для этого выполните команду:

```bash
pip install django-extensions
```

Или через poetry:

```bash
poetry add django-extensions
```

И подключить его в `settings.py`:

```python
INSTALLED_APPS = [
    ...
    'django_extensions',
]
```

После этого вы можете запустить Django Shell Plus с помощью команды:

```bash
poetry run python manage.py shell_plus
```

Или с флагом отвечающим за вывод SQL запросов:

```bash
poetry run python manage.py shell_plus --print-sql
```